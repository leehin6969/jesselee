class W{constructor(f,A=" .:-=+*#%@",o={}){const h=o.resolution||.15,i=o.scale||1,D=o.color||!1,R=o.alpha||!1,H=o.block||!1,M=o.invert||!1,C=o.strResolution||"low";let k,x;const y=document.createElement("div");y.style.cursor="default";const a=document.createElement("table");y.appendChild(a);let c,l,d;this.setSize=function(e,s){k=e,x=s,f.setSize(e,s),B()},this.render=function(e,s){f.render(e,s),T(a)},this.domElement=y;function B(){c=Math.floor(k*h),l=Math.floor(x*h),g.width=c,g.height=l,d=f.domElement,d.style.backgroundColor&&(a.rows[0].cells[0].style.backgroundColor=d.style.backgroundColor,a.rows[0].cells[0].style.color=d.style.color),a.cellSpacing="0",a.cellPadding="0";const e=a.style;e.whiteSpace="pre",e.margin="0px",e.padding="0px",e.letterSpacing=t+"px",e.fontFamily=F,e.fontSize=$+"px",e.lineHeight=O+"px",e.textAlign="left",e.textDecoration="none"}const F="courier new, monospace",G=f.domElement,g=document.createElement("canvas");if(!g.getContext)return;const m=g.getContext("2d");if(!m.getImageData)return;let n;if(A)n=A.split("");else{const e=" .,:;i1tfLCG08@".split(""),s=" CGO08@".split("");n=D?s:e}const $=2/h*i,O=2/h*i;let t=0;if(C=="low")switch(i){case 1:t=-1;break;case 2:case 3:t=-2.1;break;case 4:t=-3.1;break;case 5:t=-4.15;break}if(C=="medium")switch(i){case 1:t=0;break;case 2:t=-1;break;case 3:t=-1.04;break;case 4:case 5:t=-2.1;break}if(C=="high")switch(i){case 1:case 2:t=0;break;case 3:case 4:case 5:t=-1;break}function T(e){m.clearRect(0,0,c,l),m.drawImage(G,0,0,c,l);const s=m.getImageData(0,0,c,l).data;let u="";for(let w=0;w<l;w+=2){for(let S=0;S<c;S++){const b=(w*c+S)*4,I=s[b],E=s[b+1],v=s[b+2],z=s[b+3];let p,L;L=(.3*I+.59*E+.11*v)/255,z==0&&(L=1),p=Math.floor((1-L)*(n.length-1)),M&&(p=n.length-p-1);let r=n[p];(r===void 0||r==" ")&&(r="&nbsp;"),D?u+="<span style='color:rgb("+I+","+E+","+v+");"+(H?"background-color:rgb("+I+","+E+","+v+");":"")+(R?"opacity:"+z/255+";":"")+"'>"+r+"</span>":u+=r}u+="<br/>"}e.innerHTML=`<tr><td style="display:block;width:${k}px;height:${x}px;overflow:hidden">${u}</td></tr>`}}}export{W as AsciiEffect};
